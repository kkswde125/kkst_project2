<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pro.owner">

<select id="menuAttr1" resultType="AttrJoinDto">
SELECT T2.RK,T1.ATTR,CODE,T2.STARS 
FROM ATTRS T1,(SELECT RANK() OVER(ORDER BY AVG(STAR) DESC) AS RK, ATTR,AVG(STAR) AS STARS FROM TASTE WHERE TYPE='2주재료' GROUP BY ATTR) T2 
WHERE T1.ATTR=T2.ATTR AND RK=1 ORDER BY RK ASC
</select>

<select id="menuAttr2" resultType="AttrJoinDto">
SELECT T2.RK,T1.ATTR,CODE,T2.STARS 
FROM ATTRS T1,(SELECT RANK() OVER(ORDER BY AVG(STAR) DESC) AS RK, ATTR,AVG(STAR) AS STARS FROM TASTE WHERE TYPE='3조리방식' GROUP BY ATTR) T2 
WHERE T1.ATTR=T2.ATTR AND RK=1 ORDER BY RK ASC;
</select>

<select id="menuAttr3" resultType="AttrJoinDto">
SELECT T2.RK,T1.ATTR,CODE,T2.STARS 
FROM ATTRS T1,(SELECT RANK() OVER(ORDER BY AVG(STAR) DESC) AS RK, ATTR,AVG(STAR) AS STARS FROM TASTE WHERE TYPE='4매움정도' GROUP BY ATTR) T2 
WHERE T1.ATTR=T2.ATTR AND RK=1 ORDER BY RK ASC;
</select>
<select id="menuAttr4" resultType="AttrJoinDto">
SELECT T2.RK,T1.ATTR,CODE,T2.STARS 
FROM ATTRS T1,(SELECT RANK() OVER(ORDER BY AVG(STAR) DESC) AS RK, ATTR,AVG(STAR) AS STARS FROM TASTE WHERE TYPE='5온도' GROUP BY ATTR) T2 
WHERE T1.ATTR=T2.ATTR AND RK=1 ORDER BY RK ASC;
</select>

<select id="MenuSearch" parameterType="String" resultMap="menuDto">
SELECT SEQ,NAME,CODE,RES_SEQ,PRICE FROM MENULIST WHERE CODE=#{code}
</select>


</mapper>