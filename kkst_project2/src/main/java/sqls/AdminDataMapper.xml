<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pro.admin">

	<select id="memberList" resultType="LoginDto">
		SELECT SEQ, ID, PW, NAME, NICKNAME, REGDATE, DELFLAG, SEX, BIRTH, EMAIL FROM USERS
	</select>
	
	<select id="memberDel" parameterType="Map">
		UPDATE USERS SET DELFLAG='Y' WHERE SEQ IN
		<foreach collection="seqs" item="seq" open="(" close=")" separator="," >
			#{seq}
		</foreach>
	</select>
	
	<select id="reviewAll" resultType="ReviewDto">
		SELECT SEQ, ID, CONTENT, REFER, STAR, DEPTH, STEP, 
		RES_SEQ, REGDATE, REPORT, LIKEY, DISLIKEY, DELFLAG 
		FROM REVIEW ORDER BY SEQ
	</select>
	
<!-- 	<select id="reviewReport" resultType="ReviewDto" parameterType="int"> -->
<!-- 		SELECT REPORT FROM REVIEW WHERE SEQ = #{seq} -->
<!-- 	</select> -->
	
	<select id="reviewReport" resultType="ReviewDto" parameterType="int">
		SELECT SEQ, ID, CONTENT, REFER, STAR, DEPTH, STEP, 
		RES_SEQ, REGDATE, REPORT, LIKEY, DISLIKEY, DELFLAG 
		FROM REVIEW WHERE SEQ = #{seq}
	</select>
	
	<select id="restList" resultType="ResDto" parameterType="Map">
		SELECT SEQ, NAME, CATE, ADDR, 'CALL', 'START', 'END', 
		REST_START, REST_END, PARKING, 'OPEN', CHK, 'COMMENT', X, Y 
		FROM
		(SELECT ROW_NUMBER() OVER(ORDER BY SEQ) AS RN, 
		SEQ, NAME, CATE, ADDR, 'CALL', 'START', 'END', 
		REST_START, REST_END, PARKING, 'OPEN', CHK, 'COMMENT', X, Y 
		FROM RESLIST WHERE CHK = 'N') WHERE RN BETWEEN #{snum} AND #{cnum}
	</select>
	
	<select id="pageCnt" resultType="int">
		SELECT CEIL(COUNT(*)/10) CNT FROM RESLIST WHERE CHK='N'
	</select>
	
	<select id="restChk" parameterType="Map">
		UPDATE RESLIST SET CHK='Y', X=#{x}, Y=#{y} WHERE SEQ = #{seq}
	</select>
	
	<select id="restChkEmail" parameterType="int">
		SELECT RESLIST.SEQ, EMAIL FROM RESLIST, ADMIN_OWNER 
		WHERE RESLIST.SEQ = ADMIN_OWNER.RES_SEQ 
		AND RESLIST.SEQ = #{seq}
	</select>
	
	<select id="restDel" parameterType="int">
		UPDATE RESLIST SET CHK='DEL' WHERE SEQ = #{seq}
	</select>

</mapper>